const I18n = (() => {
  'use strict';

  const LANGS = ['en', 'ko', 'zh'];
  const DEFAULT_LANG = 'en';
  let current = DEFAULT_LANG;

  const T = {
    en: {
      title: 'Liquidation Risk',
      sectionFuture: 'Future',
      sectionCurrent: 'Current',
      symbol: 'Symbol',
      liqPrice: 'Liquidation Price',
      side: 'Side',
      leverage: 'Leverage',
      startMonitoring: 'Start Monitoring',
      stop: 'Stop',
      errSymbol: 'Please enter a symbol',
      errLiqPrice: 'Please enter liquidation price',
      reachProb: 'Reach Prob.',
      distance: 'Distance',
      direction: 'Direction',
      liqPriceLabel: 'Liq. Price',
      current: 'Current',
      details: 'Details',
      densityScore: 'Density Score',
      orderBookPath: 'Order Book Path',
      depth: 'Depth',
      notional: 'Notional',
      levels: 'Levels',
      depthRatio: 'Depth Ratio',
      liqClusters: 'Liquidation Clusters',
      noClusters: 'No clusters in range',
      marketPressure: 'Market Pressure',
      totalPressure: 'Total Pressure',
      dirDown: '▼ Down',
      dirUp: '▲ Up',
      popupTitle: 'Liquidation Risk Monitor',
      popupIntro: 'A Chrome extension that predicts <strong>liquidation risk</strong> for Binance Futures positions in real-time using two complementary models.',
      popupUsageTitle: 'How to Use',
      popupUsage1: 'The widget appears automatically on the Binance Futures page.',
      popupUsage2: 'Enter <strong>Symbol</strong>, <strong>Liquidation Price</strong>, <strong>Side</strong> (Long/Short), and <strong>Leverage</strong>.',
      popupUsage3: 'Click <em>Start Monitoring</em> to begin real-time risk analysis.',
      popupUsage4: 'Expand <em>Details</em> to view detailed metrics.',
      popupMcTitle: 'Monte Carlo Simulation',
      popupMcDesc: 'Predicts the probability of reaching liquidation price by simulating thousands of future price paths. Uses GARCH volatility, funding rate drift, and Student-t fat tails for realistic modeling.',
      labelMcRisk: 'MC Risk',
      labelHorizon: 'Horizons',
      labelSigma: 'Volatility(σ)',
      labelPaths: 'Paths',
      descMcRisk: 'MC risk grade based on 24h liquidation probability',
      descMcHorizon: 'Liquidation probability at each time horizon (10m / 1h / 4h / 24h)',
      descMcSigma: 'Annualized volatility used for simulation',
      descMcPaths: 'Number of price paths simulated',
      popupCascadeTitle: 'Cascade Risk Analysis',
      popupCascadeDesc: 'Evaluates the current market structure between current price and liquidation price in real-time. Analyzes order book depth, liquidation clusters, and market pressure to estimate cascade liquidation risk.',
      popupBasicTitle: 'Basic Metrics',
      labelRiskLevel: 'Risk Level',
      labelReachProb: 'Reach Prob.',
      labelDistance: 'Distance',
      labelDirection: 'Direction',
      descRiskLevel: 'Overall risk grade (LOW / MEDIUM / HIGH / CRITICAL)',
      descReachProb: 'Estimated probability of price reaching liquidation (%)',
      descDistance: 'Distance between current and liquidation price (%)',
      descDirection: 'Liquidation direction (Long→Down, Short→Up)',
      popupDetailTitle: 'Detail Metrics',
      labelDensity: 'Density Score',
      labelDepthNotional: 'Depth / Notional',
      labelLevelsRatio: 'Levels / Depth Ratio',
      labelClusters: 'Liq. Clusters',
      labelOI: 'OI Pressure',
      labelLiq: 'Liq Intensity',
      labelImbal: 'Imbalance',
      descDensity: 'Order book density score in the price range (0–100)',
      descDepthNotional: 'Order quantity (BTC) and notional value (USDT) in range',
      descLevelsRatio: 'Price levels in range / ratio to total order book',
      descClusters: 'Estimated liquidation clusters by leverage in range',
      descOI: 'Market pressure from OI change rate (0–20)',
      descLiq: 'Forced liquidation frequency + volume in last 30min (0–20)',
      descImbal: 'Order book bid/ask imbalance (0–20)',
      popupFooter: 'Binance Futures only · Real-time WebSocket',
      mcTitle: 'MC Simulation',
      mcNoData: 'Waiting for MC data...',
      mcVolatility: 'Volatility(σ)',
      mcPaths: 'Paths',
      mcRisk: 'MC Risk',
      mc10m: '10min',
      mc1h: '1hr',
      mc4h: '4hr',
      mc24h: '24hr',
    },
    ko: {
      title: '청산 위험도',
      sectionFuture: '향후',
      sectionCurrent: '현재',
      symbol: '심볼',
      liqPrice: '청산가',
      side: '방향',
      leverage: '레버리지',
      startMonitoring: '모니터링 시작',
      stop: '중지',
      errSymbol: '심볼을 입력하세요',
      errLiqPrice: '청산가를 입력하세요',
      reachProb: '도달 확률',
      distance: '거리',
      direction: '방향',
      liqPriceLabel: '청산가',
      current: '현재가',
      details: '상세 보기',
      densityScore: '밀도 점수',
      orderBookPath: '호가창 경로',
      depth: '물량',
      notional: '명목가치',
      levels: '호가 단계',
      depthRatio: '물량 비율',
      liqClusters: '청산 클러스터',
      noClusters: '구간 내 클러스터 없음',
      marketPressure: '시장 압력',
      totalPressure: '총 압력',
      dirDown: '▼ 하락',
      dirUp: '▲ 상승',
      popupTitle: '청산 위험도 모니터',
      popupIntro: '바이낸스 선물 포지션의 <strong>청산 위험</strong>을 두 가지 상호보완적 모델로 실시간 예측하는 확장 프로그램입니다.',
      popupUsageTitle: '사용법',
      popupUsage1: '바이낸스 선물 페이지에 접속하면 위젯이 자동으로 나타납니다.',
      popupUsage2: '<strong>심볼</strong>, <strong>청산가</strong>, <strong>방향</strong>(Long/Short), <strong>레버리지</strong>를 입력합니다.',
      popupUsage3: '<em>모니터링 시작</em>을 누르면 실시간 위험 분석이 시작됩니다.',
      popupUsage4: '<em>상세 보기</em>를 펼치면 상세 지표를 확인할 수 있습니다.',
      popupMcTitle: '몬테카를로 시뮬레이션',
      popupMcDesc: '수천 개의 미래 가격 경로를 시뮬레이션하여 청산가 도달 확률을 예측합니다. GARCH 변동성, 펀딩비 드리프트, Student-t 꼬리 위험을 반영하여 현실적인 시나리오를 모델링합니다.',
      labelMcRisk: 'MC 위험',
      labelHorizon: '시간대별 확률',
      labelSigma: '변동성(σ)',
      labelPaths: '경로',
      descMcRisk: '24시간 청산 확률 기반 MC 위험 등급',
      descMcHorizon: '시간대별 청산 확률 (10분 / 1시간 / 4시간 / 24시간)',
      descMcSigma: '시뮬레이션에 사용된 연율화 변동성',
      descMcPaths: '시뮬레이션 경로 수',
      popupCascadeTitle: '연쇄 청산 위험 분석',
      popupCascadeDesc: '현재가와 청산가 사이의 시장 구조를 실시간으로 평가합니다. 오더북 유동성, 청산 클러스터, 시장 압력 지표를 종합하여 연쇄 청산 가능성을 분석합니다.',
      popupBasicTitle: '기본 지표',
      labelRiskLevel: '위험 등급',
      labelReachProb: '도달 확률',
      labelDistance: '거리',
      labelDirection: '방향',
      descRiskLevel: '종합 위험 등급 (LOW / MEDIUM / HIGH / CRITICAL)',
      descReachProb: '가격이 청산가에 도달할 추정 확률 (%)',
      descDistance: '현재가와 청산가 사이의 거리 (%)',
      descDirection: '청산 방향 (Long→Down, Short→Up)',
      popupDetailTitle: '상세 지표',
      labelDensity: '밀도 점수',
      labelDepthNotional: '물량 / 명목가치',
      labelLevelsRatio: '호가 단계 / 물량 비율',
      labelClusters: '청산 클러스터',
      labelOI: 'OI 압력',
      labelLiq: '청산 강도',
      labelImbal: '불균형',
      descDensity: '현재가~청산가 구간의 오더북 밀도 종합 점수 (0~100)',
      descDepthNotional: '구간 내 주문 수량(BTC) 및 명목가치(USDT)',
      descLevelsRatio: '구간 내 호가 단계 수 / 전체 오더북 대비 비율',
      descClusters: '구간 내 추정 청산 클러스터 (레버리지별 분포)',
      descOI: '미결제약정(OI) 변동률 기반 시장 압력 (0~20)',
      descLiq: '최근 30분 강제 청산 빈도 + 규모 (0~20)',
      descImbal: '오더북 매수/매도 불균형 정도 (0~20)',
      popupFooter: '바이낸스 선물 전용 · 실시간 WebSocket 연동',
      mcTitle: 'MC 시뮬레이션',
      mcNoData: 'MC 데이터 대기 중...',
      mcVolatility: '변동성(σ)',
      mcPaths: '경로',
      mcRisk: 'MC 위험',
      mc10m: '10분',
      mc1h: '1시간',
      mc4h: '4시간',
      mc24h: '24시간',
    },
    zh: {
      title: '清算风险度',
      sectionFuture: '未来',
      sectionCurrent: '当前',
      symbol: '交易对',
      liqPrice: '清算价格',
      side: '方向',
      leverage: '杠杆',
      startMonitoring: '开始监控',
      stop: '停止',
      errSymbol: '请输入交易对',
      errLiqPrice: '请输入清算价格',
      reachProb: '到达概率',
      distance: '距离',
      direction: '方向',
      liqPriceLabel: '清算价',
      current: '当前价',
      details: '详细信息',
      densityScore: '密度评分',
      orderBookPath: '订单簿路径',
      depth: '深度',
      notional: '名义价值',
      levels: '价格档位',
      depthRatio: '深度比例',
      liqClusters: '清算集群',
      noClusters: '范围内无集群',
      marketPressure: '市场压力',
      totalPressure: '总压力',
      dirDown: '▼ 下跌',
      dirUp: '▲ 上涨',
      popupTitle: '清算风险度监控',
      popupIntro: '通过两种互补模型，实时预测币安合约仓位的<strong>清算风险</strong>的扩展程序。',
      popupUsageTitle: '使用方法',
      popupUsage1: '访问币安合约页面时，小部件会自动出现。',
      popupUsage2: '输入<strong>交易对</strong>、<strong>清算价格</strong>、<strong>方向</strong>(Long/Short)和<strong>杠杆</strong>。',
      popupUsage3: '点击<em>开始监控</em>启动实时风险分析。',
      popupUsage4: '展开<em>详细信息</em>查看详细指标。',
      popupMcTitle: '蒙特卡洛模拟',
      popupMcDesc: '通过模拟数千条未来价格路径来预测到达清算价的概率。使用GARCH波动率、资金费率漂移和Student-t厚尾进行现实建模。',
      labelMcRisk: 'MC风险',
      labelHorizon: '各时段概率',
      labelSigma: '波动率(σ)',
      labelPaths: '路径',
      descMcRisk: '基于24小时清算概率的MC风险等级',
      descMcHorizon: '各时间段清算概率 (10分钟 / 1小时 / 4小时 / 24小时)',
      descMcSigma: '模拟使用的年化波动率',
      descMcPaths: '模拟路径数量',
      popupCascadeTitle: '级联清算风险分析',
      popupCascadeDesc: '实时评估当前价与清算价之间的市场结构。综合分析订单簿深度、清算集群和市场压力指标，评估级联清算可能性。',
      popupBasicTitle: '基本指标',
      labelRiskLevel: '风险等级',
      labelReachProb: '到达概率',
      labelDistance: '距离',
      labelDirection: '方向',
      descRiskLevel: '综合风险等级 (LOW / MEDIUM / HIGH / CRITICAL)',
      descReachProb: '价格到达清算价的估计概率 (%)',
      descDistance: '当前价与清算价之间的距离 (%)',
      descDirection: '清算方向 (Long→下跌, Short→上涨)',
      popupDetailTitle: '详细指标',
      labelDensity: '密度评分',
      labelDepthNotional: '深度 / 名义价值',
      labelLevelsRatio: '价格档位 / 深度比例',
      labelClusters: '清算集群',
      labelOI: 'OI压力',
      labelLiq: '清算强度',
      labelImbal: '不平衡',
      descDensity: '当前价~清算价区间的订单簿密度综合评分 (0~100)',
      descDepthNotional: '区间内订单数量(BTC)及名义价值(USDT)',
      descLevelsRatio: '区间内价格档位数 / 占总订单簿比例',
      descClusters: '区间内按杠杆分布的预估清算集群',
      descOI: '基于未平仓合约(OI)变动率的市场压力 (0~20)',
      descLiq: '最近30分钟强制清算频率 + 规模 (0~20)',
      descImbal: '订单簿买卖不平衡程度 (0~20)',
      popupFooter: '仅限币安合约 · 实时WebSocket连接',
      mcTitle: 'MC 模拟',
      mcNoData: '等待MC数据...',
      mcVolatility: '波动率(σ)',
      mcPaths: '路径',
      mcRisk: 'MC风险',
      mc10m: '10分钟',
      mc1h: '1小时',
      mc4h: '4小时',
      mc24h: '24小时',
    },
  };

  function get(key) {
    return (T[current] && T[current][key]) || T[DEFAULT_LANG][key] || key;
  }

  function setLang(lang) {
    if (LANGS.includes(lang)) current = lang;
  }

  function getLang() {
    return current;
  }

  function getLangs() {
    return LANGS;
  }

  return { get, setLang, getLang, getLangs, T };
})();
