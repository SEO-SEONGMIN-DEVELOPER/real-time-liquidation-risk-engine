const DashboardI18n = (() => {
  "use strict";

  const LANGS = ["en", "ko", "zh", "ja", "tr", "ru", "es", "pt"];
  const DEFAULT_LANG = "en";

  const T = {
    en: {
      brandTitle: "LIQUIDATION TERMINAL",
      wsConnected: "Connected",
      wsDisconnected: "Disconnected",
      setupTitle: "Risk Monitor Setup",
      setupSub: "Enter position info and start real-time liquidation risk monitoring.",
      labelSymbol: "Symbol",
      labelLiqPrice: "Liquidation Price",
      labelSide: "Position",
      labelLeverage: "Leverage",
      sideLong: "LONG",
      sideShort: "SHORT",
      startMonitoring: "Start Monitoring",
      btnBack: "Setup",
      btnStop: "Stop",
      liveDashboard: "Live Risk Dashboard",
      sectionCurrent: "Current",
      sectionForecast: "Forecast",
      summarySymbol: "Symbol",
      summaryCascadeRisk: "Cascade Risk",
      summaryReachProb: "Reach Prob.",
      summaryMcRisk: "MC Risk",
      cascadeMetrics: "Cascade Liquidation Risk",
      monteCarlo: "MC Simulation-Based Liquidation Reach Probability",
      metricDistance: "Distance",
      metricDirection: "Direction",
      metricDensityScore: "Density Score",
      metricMarketPressure: "Market Pressure",
      metricCurrentPrice: "Current Price",
      metricLiqPrice: "Liquidation Price",
      metricOiScore: "OI Score",
      metricLiqScore: "Liq Score",
      metricImbalance: "Imbalance",
      mcNoData: "No Monte Carlo data yet.",
      mcVolatility: "Volatility(σ)",
      mcPaths: "Paths",
      tagLiqPrefix: "Liq",
      feedbackTitle: "Leave Feedback",
      feedbackSub: "Share ideas, bugs, or any suggestions for improvement.",
      feedbackSubmit: "Send Feedback",
      feedbackNamePlaceholder: "Nickname (optional)",
      feedbackMessagePlaceholder: "Write your feedback here.",
      feedbackSent: "Thanks! Your feedback has been sent.",
      feedbackError: "Failed to send feedback. Please try again.",
      feedbackValidation: "Please enter your feedback message.",
      msgSelectSymbol: "Please select a symbol.",
      msgInvalidLiq: "Please enter a valid liquidation price.",
      msgStarting: "Starting monitoring...",
      msgStarted: "{symbol} monitoring started.",
      msgStartFailed: "Failed to start monitoring.",
      msgStopped: "{symbol} monitoring stopped.",
      msgStopFailed: "Error while stopping monitoring.",
      msgWsLibMissing: "Failed to load STOMP libraries.",
      msgWsDisconnected: "WebSocket disconnected. Reconnecting..."
    },
    ko: {
      brandTitle: "LIQUIDATION TERMINAL",
      wsConnected: "연결됨",
      wsDisconnected: "연결 끊김",
      setupTitle: "리스크 모니터 설정",
      setupSub: "포지션 정보를 입력하고 실시간 청산 위험 모니터링을 시작하세요.",
      labelSymbol: "종목명",
      labelLiqPrice: "청산가",
      labelSide: "포지션",
      labelLeverage: "레버리지",
      sideLong: "LONG",
      sideShort: "SHORT",
      startMonitoring: "모니터링 시작",
      btnBack: "설정으로",
      btnStop: "중지",
      liveDashboard: "실시간 리스크 대시보드",
      sectionCurrent: "현재",
      sectionForecast: "예측",
      summarySymbol: "종목",
      summaryCascadeRisk: "Cascade 위험도",
      summaryReachProb: "도달 확률",
      summaryMcRisk: "MC 위험도",
      cascadeMetrics: "연쇄 청산 위험도",
      monteCarlo: "MC 시뮬레이션 기반 청산가 도달 확률",
      metricDistance: "거리",
      metricDirection: "방향",
      metricDensityScore: "밀도 점수",
      metricMarketPressure: "시장 압력",
      metricCurrentPrice: "현재가",
      metricLiqPrice: "청산가",
      metricOiScore: "OI 점수",
      metricLiqScore: "청산 점수",
      metricImbalance: "불균형",
      mcNoData: "아직 Monte Carlo 데이터가 없습니다.",
      mcVolatility: "변동성(σ)",
      mcPaths: "경로 수",
      tagLiqPrefix: "청산가",
      feedbackTitle: "의견 남기기",
      feedbackSub: "개선 아이디어나 버그를 자유롭게 남겨주세요.",
      feedbackSubmit: "의견 보내기",
      feedbackNamePlaceholder: "닉네임(선택)",
      feedbackMessagePlaceholder: "의견을 입력해주세요.",
      feedbackSent: "의견이 전송되었습니다. 감사합니다.",
      feedbackError: "전송에 실패했습니다. 잠시 후 다시 시도해주세요.",
      feedbackValidation: "의견 내용을 입력해주세요.",
      msgSelectSymbol: "종목명을 선택하세요.",
      msgInvalidLiq: "청산가를 올바르게 입력하세요.",
      msgStarting: "모니터링을 시작하는 중입니다...",
      msgStarted: "{symbol} 모니터링이 시작되었습니다.",
      msgStartFailed: "모니터링 시작 실패",
      msgStopped: "{symbol} 모니터링을 중지했습니다.",
      msgStopFailed: "중지 처리 중 오류가 발생했습니다.",
      msgWsLibMissing: "STOMP 라이브러리를 불러오지 못했습니다.",
      msgWsDisconnected: "웹소켓 연결이 끊어졌습니다. 자동 재연결을 시도합니다."
    },
    zh: {
      brandTitle: "LIQUIDATION TERMINAL",
      wsConnected: "已连接",
      wsDisconnected: "未连接",
      setupTitle: "风险监控设置",
      setupSub: "输入仓位信息并开始实时清算风险监控。",
      labelSymbol: "交易对",
      labelLiqPrice: "清算价",
      labelSide: "方向",
      labelLeverage: "杠杆",
      sideLong: "LONG",
      sideShort: "SHORT",
      startMonitoring: "开始监控",
      btnBack: "返回设置",
      btnStop: "停止",
      liveDashboard: "实时风险面板",
      sectionCurrent: "当前",
      sectionForecast: "预测",
      summarySymbol: "交易对",
      summaryCascadeRisk: "Cascade 风险",
      summaryReachProb: "触达概率",
      summaryMcRisk: "MC 风险",
      cascadeMetrics: "连锁清算风险",
      monteCarlo: "基于MC模拟的清算价触达概率",
      metricDistance: "距离",
      metricDirection: "方向",
      metricDensityScore: "密度评分",
      metricMarketPressure: "市场压力",
      metricCurrentPrice: "当前价格",
      metricLiqPrice: "清算价格",
      metricOiScore: "OI 分数",
      metricLiqScore: "清算分数",
      metricImbalance: "失衡",
      mcNoData: "暂无 Monte Carlo 数据。",
      mcVolatility: "波动率(σ)",
      mcPaths: "路径数",
      tagLiqPrefix: "清算价",
      msgSelectSymbol: "请选择交易对。",
      msgInvalidLiq: "请输入有效清算价。",
      msgStarting: "正在启动监控...",
      msgStarted: "{symbol} 监控已启动。",
      msgStartFailed: "启动监控失败。",
      msgStopped: "{symbol} 监控已停止。",
      msgStopFailed: "停止监控时发生错误。",
      msgWsLibMissing: "无法加载 STOMP 库。",
      msgWsDisconnected: "WebSocket 已断开，正在重连..."
    },
    ja: {
      brandTitle: "LIQUIDATION TERMINAL",
      wsConnected: "接続中",
      wsDisconnected: "未接続",
      setupTitle: "リスク監視設定",
      setupSub: "ポジション情報を入力してリアルタイム監視を開始します。",
      labelSymbol: "通貨ペア",
      labelLiqPrice: "清算価格",
      labelSide: "ポジション",
      labelLeverage: "レバレッジ",
      sideLong: "LONG",
      sideShort: "SHORT",
      startMonitoring: "監視開始",
      btnBack: "設定へ",
      btnStop: "停止",
      liveDashboard: "ライブリスクダッシュボード",
      sectionCurrent: "現在",
      sectionForecast: "予測",
      summarySymbol: "通貨ペア",
      summaryCascadeRisk: "Cascade リスク",
      summaryReachProb: "到達確率",
      summaryMcRisk: "MC リスク",
      cascadeMetrics: "連鎖清算リスク",
      monteCarlo: "MCシミュレーションベースの清算価格到達確率",
      metricDistance: "距離",
      metricDirection: "方向",
      metricDensityScore: "密度スコア",
      metricMarketPressure: "市場圧力",
      metricCurrentPrice: "現在価格",
      metricLiqPrice: "清算価格",
      metricOiScore: "OI スコア",
      metricLiqScore: "清算スコア",
      metricImbalance: "不均衡",
      mcNoData: "Monte Carlo データがありません。",
      mcVolatility: "ボラティリティ(σ)",
      mcPaths: "パス数",
      tagLiqPrefix: "清算価",
      msgSelectSymbol: "通貨ペアを選択してください。",
      msgInvalidLiq: "有効な清算価格を入力してください。",
      msgStarting: "監視を開始しています...",
      msgStarted: "{symbol} の監視を開始しました。",
      msgStartFailed: "監視の開始に失敗しました。",
      msgStopped: "{symbol} の監視を停止しました。",
      msgStopFailed: "停止処理中にエラーが発生しました。",
      msgWsLibMissing: "STOMPライブラリを読み込めません。",
      msgWsDisconnected: "WebSocketが切断されました。再接続中..."
    },
    tr: {
      brandTitle: "LIQUIDATION TERMINAL",
      wsConnected: "Bağlı",
      wsDisconnected: "Bağlantı yok",
      setupTitle: "Risk İzleme Ayarları",
      setupSub: "Pozisyon bilgilerini girip gerçek zamanlı izlemeyi başlatın.",
      labelSymbol: "Sembol",
      labelLiqPrice: "Likidasyon Fiyatı",
      labelSide: "Pozisyon",
      labelLeverage: "Kaldıraç",
      sideLong: "LONG",
      sideShort: "SHORT",
      startMonitoring: "İzlemeyi Başlat",
      btnBack: "Ayarlara dön",
      btnStop: "Durdur",
      liveDashboard: "Canlı Risk Paneli",
      sectionCurrent: "Güncel",
      sectionForecast: "Tahmin",
      summarySymbol: "Sembol",
      summaryCascadeRisk: "Cascade Risk",
      summaryReachProb: "Ulaşma Olas.",
      summaryMcRisk: "MC Risk",
      cascadeMetrics: "Kademeli Likidasyon Riski",
      monteCarlo: "MC Simülasyon Tabanlı Likidasyon Fiyatına Ulaşma Olasılığı",
      metricDistance: "Mesafe",
      metricDirection: "Yön",
      metricDensityScore: "Yoğunluk",
      metricMarketPressure: "Piyasa Baskısı",
      metricCurrentPrice: "Güncel Fiyat",
      metricLiqPrice: "Likidasyon Fiyatı",
      metricOiScore: "OI Skoru",
      metricLiqScore: "Likidasyon Skoru",
      metricImbalance: "Dengesizlik",
      mcNoData: "Henüz Monte Carlo verisi yok.",
      mcVolatility: "Volatilite(σ)",
      mcPaths: "Yol Sayısı",
      tagLiqPrefix: "Lik.",
      msgSelectSymbol: "Lütfen sembol seçin.",
      msgInvalidLiq: "Geçerli likidasyon fiyatı girin.",
      msgStarting: "İzleme başlatılıyor...",
      msgStarted: "{symbol} izleme başladı.",
      msgStartFailed: "İzleme başlatılamadı.",
      msgStopped: "{symbol} izleme durduruldu.",
      msgStopFailed: "Durdurma sırasında hata oluştu.",
      msgWsLibMissing: "STOMP kütüphanesi yüklenemedi.",
      msgWsDisconnected: "WebSocket bağlantısı kesildi. Yeniden bağlanılıyor..."
    },
    ru: {
      brandTitle: "LIQUIDATION TERMINAL",
      wsConnected: "Подключено",
      wsDisconnected: "Отключено",
      setupTitle: "Настройка мониторинга",
      setupSub: "Введите параметры позиции и запустите мониторинг в реальном времени.",
      labelSymbol: "Пара",
      labelLiqPrice: "Цена ликвидации",
      labelSide: "Позиция",
      labelLeverage: "Плечо",
      sideLong: "LONG",
      sideShort: "SHORT",
      startMonitoring: "Начать мониторинг",
      btnBack: "К настройке",
      btnStop: "Стоп",
      liveDashboard: "Панель риска",
      sectionCurrent: "Текущее",
      sectionForecast: "Прогноз",
      summarySymbol: "Пара",
      summaryCascadeRisk: "Cascade риск",
      summaryReachProb: "Вер. достижения",
      summaryMcRisk: "MC риск",
      cascadeMetrics: "Риск каскадной ликвидации",
      monteCarlo: "Вероятность достижения цены ликвидации на основе MC-симуляции",
      metricDistance: "Дистанция",
      metricDirection: "Направление",
      metricDensityScore: "Плотность",
      metricMarketPressure: "Давление рынка",
      metricCurrentPrice: "Текущая цена",
      metricLiqPrice: "Цена ликвидации",
      metricOiScore: "OI балл",
      metricLiqScore: "Баллы ликвидации",
      metricImbalance: "Дисбаланс",
      mcNoData: "Данные Monte Carlo отсутствуют.",
      mcVolatility: "Волатильность(σ)",
      mcPaths: "Пути",
      tagLiqPrefix: "Ликв.",
      msgSelectSymbol: "Выберите торговую пару.",
      msgInvalidLiq: "Введите корректную цену ликвидации.",
      msgStarting: "Запуск мониторинга...",
      msgStarted: "Мониторинг {symbol} запущен.",
      msgStartFailed: "Не удалось запустить мониторинг.",
      msgStopped: "Мониторинг {symbol} остановлен.",
      msgStopFailed: "Ошибка при остановке мониторинга.",
      msgWsLibMissing: "Не удалось загрузить библиотеку STOMP.",
      msgWsDisconnected: "WebSocket отключен. Повторное подключение..."
    },
    es: {
      brandTitle: "LIQUIDATION TERMINAL",
      wsConnected: "Conectado",
      wsDisconnected: "Desconectado",
      setupTitle: "Configuración de Monitoreo",
      setupSub: "Ingresa la posición y comienza el monitoreo en tiempo real.",
      labelSymbol: "Símbolo",
      labelLiqPrice: "Precio de Liquidación",
      labelSide: "Posición",
      labelLeverage: "Apalancamiento",
      sideLong: "LONG",
      sideShort: "SHORT",
      startMonitoring: "Iniciar Monitoreo",
      btnBack: "Ajustes",
      btnStop: "Detener",
      liveDashboard: "Panel de Riesgo en Vivo",
      sectionCurrent: "Actual",
      sectionForecast: "Proyección",
      summarySymbol: "Símbolo",
      summaryCascadeRisk: "Riesgo Cascade",
      summaryReachProb: "Prob. alcance",
      summaryMcRisk: "Riesgo MC",
      cascadeMetrics: "Riesgo de Liquidación en Cascada",
      monteCarlo: "Probabilidad de Alcanzar el Precio de Liquidación Basada en Simulación MC",
      metricDistance: "Distancia",
      metricDirection: "Dirección",
      metricDensityScore: "Densidad",
      metricMarketPressure: "Presión del Mercado",
      metricCurrentPrice: "Precio Actual",
      metricLiqPrice: "Precio de Liquidación",
      metricOiScore: "Puntaje OI",
      metricLiqScore: "Puntaje Liq",
      metricImbalance: "Desequilibrio",
      mcNoData: "Aún no hay datos de Monte Carlo.",
      mcVolatility: "Volatilidad(σ)",
      mcPaths: "Trayectorias",
      tagLiqPrefix: "Liq.",
      msgSelectSymbol: "Selecciona un símbolo.",
      msgInvalidLiq: "Ingresa un precio de liquidación válido.",
      msgStarting: "Iniciando monitoreo...",
      msgStarted: "Monitoreo de {symbol} iniciado.",
      msgStartFailed: "No se pudo iniciar el monitoreo.",
      msgStopped: "Monitoreo de {symbol} detenido.",
      msgStopFailed: "Error al detener el monitoreo.",
      msgWsLibMissing: "No se pudo cargar la librería STOMP.",
      msgWsDisconnected: "WebSocket desconectado. Reconectando..."
    },
    pt: {
      brandTitle: "LIQUIDATION TERMINAL",
      wsConnected: "Conectado",
      wsDisconnected: "Desconectado",
      setupTitle: "Configuração do Monitor",
      setupSub: "Informe a posição e inicie o monitoramento em tempo real.",
      labelSymbol: "Símbolo",
      labelLiqPrice: "Preço de Liquidação",
      labelSide: "Posição",
      labelLeverage: "Alavancagem",
      sideLong: "LONG",
      sideShort: "SHORT",
      startMonitoring: "Iniciar Monitoramento",
      btnBack: "Configuração",
      btnStop: "Parar",
      liveDashboard: "Painel de Risco ao Vivo",
      sectionCurrent: "Atual",
      sectionForecast: "Projeção",
      summarySymbol: "Símbolo",
      summaryCascadeRisk: "Risco Cascade",
      summaryReachProb: "Prob. alcance",
      summaryMcRisk: "Risco MC",
      cascadeMetrics: "Risco de Liquidação em Cascata",
      monteCarlo: "Probabilidade de Atingir o Preço de Liquidação Baseada em Simulação MC",
      metricDistance: "Distância",
      metricDirection: "Direção",
      metricDensityScore: "Densidade",
      metricMarketPressure: "Pressão de Mercado",
      metricCurrentPrice: "Preço Atual",
      metricLiqPrice: "Preço de Liquidação",
      metricOiScore: "Score OI",
      metricLiqScore: "Score Liq",
      metricImbalance: "Desequilíbrio",
      mcNoData: "Ainda não há dados de Monte Carlo.",
      mcVolatility: "Volatilidade(σ)",
      mcPaths: "Trajetórias",
      tagLiqPrefix: "Liq.",
      msgSelectSymbol: "Selecione um símbolo.",
      msgInvalidLiq: "Informe um preço de liquidação válido.",
      msgStarting: "Iniciando monitoramento...",
      msgStarted: "Monitoramento de {symbol} iniciado.",
      msgStartFailed: "Falha ao iniciar monitoramento.",
      msgStopped: "Monitoramento de {symbol} encerrado.",
      msgStopFailed: "Erro ao encerrar monitoramento.",
      msgWsLibMissing: "Falha ao carregar biblioteca STOMP.",
      msgWsDisconnected: "WebSocket desconectado. Reconectando..."
    }
  };

  let current = localStorage.getItem("riskDashboardLang") || DEFAULT_LANG;
  if (!LANGS.includes(current)) current = DEFAULT_LANG;

  function setLang(lang) {
    if (LANGS.includes(lang)) {
      current = lang;
      localStorage.setItem("riskDashboardLang", lang);
    }
  }

  function getLang() {
    return current;
  }

  function get(key, vars = {}) {
    const msg = (T[current] && T[current][key]) || T[DEFAULT_LANG][key] || key;
    return msg.replace(/\{(\w+)\}/g, (_, k) => String(vars[k] ?? ""));
  }

  return { get, setLang, getLang, LANGS };
})();
